{% extends 'auctions/layout.html' %}

{% block body %}
  
<!-- Listing Info -->
<div class="listing">
    <img src="{{listing.image_url}}" alt="product image" class="detail-image">
    <div>
        <div>
        <h2>{{listing.title}}</h2> 
        <!-- Listing details: -->
        {% include 'auctions/watchlist_controls.html' %}
        <p><span class="label">Category:</span> {{listing.category}}</p>
        <p><span class="label">Listed by:</span> {{listing.owner}} on {{listing.timestamp}}</p>
        <p><span class="label">Description: </span>{{listing.description}}</p>

        <!-- Show the owner's or bidder's controls, depending on the user-->
        {% if user == listing.owner %}
        {% include 'auctions/owners_controls.html' %}
        {% else %}
        {% include 'auctions/bidding_controls.html' %}
        {% endif %}

        <!-- Comments block -->
        <h3>Comments</h3>
        {% for comment in comments %}
        <blockquote>
        <p class="comment-body">{{comment.body}}</p>
        <p>- {{comment.commenter}}, {{comment.timestamp}}</p>
        </blockquote>
        {% endfor %}
        <h4>Leave a Comment</h4>
        {% if user.is_authenticated %}
        <form action="{% url 'comment_add' %}" method="POST" class="comment-form">
            {% csrf_token %}
            {{ comment_form }}
            <input type="submit" class="btn btn-primary link-as-button">
        </form>
    {% else %}
        <p>You must <a href="{% url 'login' %}">log in</a> to post comments.</p>
    {% endif %}
    </div>
</div>


{% endblock %}